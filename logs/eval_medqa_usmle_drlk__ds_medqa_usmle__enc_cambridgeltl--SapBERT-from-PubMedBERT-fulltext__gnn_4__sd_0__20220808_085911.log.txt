loading adj matrices:   0%|          | 0/40712 [00:00<?, ?it/s]/mnt/zm/DRLK/utils/data_utils.py:256: UserWarning: indexing with dtype torch.uint8 is now deprecated, please use a dtype torch.bool instead. (Triggered internally at  /pytorch/aten/src/ATen/native/IndexingUtils.h:30.)
  node_type_ids[idx, :num_concept][torch.tensor(
/mnt/zm/DRLK/utils/data_utils.py:258: UserWarning: indexing with dtype torch.uint8 is now deprecated, please use a dtype torch.bool instead. (Triggered internally at  /pytorch/aten/src/ATen/native/IndexingUtils.h:30.)
  node_type_ids[idx, :num_concept][torch.tensor(
loading adj matrices:   2%|▏         | 620/40712 [00:00<00:06, 6190.22it/s]loading adj matrices:   3%|▎         | 1240/40712 [00:00<00:06, 6122.26it/s]loading adj matrices:   5%|▍         | 1859/40712 [00:00<00:06, 6149.46it/s]loading adj matrices:   6%|▌         | 2478/40712 [00:00<00:06, 6162.63it/s]loading adj matrices:   8%|▊         | 3099/40712 [00:00<00:06, 6177.81it/s]loading adj matrices:   9%|▉         | 3717/40712 [00:00<00:06, 6155.64it/s]loading adj matrices:  11%|█         | 4333/40712 [00:00<00:05, 6150.13it/s]loading adj matrices:  12%|█▏        | 4949/40712 [00:00<00:05, 6063.48it/s]loading adj matrices:  14%|█▎        | 5556/40712 [00:00<00:07, 4812.84it/s]loading adj matrices:  15%|█▌        | 6161/40712 [00:01<00:06, 5131.83it/s]loading adj matrices:  17%|█▋        | 6765/40712 [00:01<00:06, 5375.96it/s]loading adj matrices:  18%|█▊        | 7371/40712 [00:01<00:05, 5564.31it/s]loading adj matrices:  20%|█▉        | 7966/40712 [00:01<00:05, 5671.64it/s]loading adj matrices:  21%|██        | 8569/40712 [00:01<00:05, 5773.44it/s]loading adj matrices:  23%|██▎       | 9171/40712 [00:01<00:05, 5844.53it/s]loading adj matrices:  24%|██▍       | 9764/40712 [00:01<00:05, 5840.12it/s]loading adj matrices:  25%|██▌       | 10367/40712 [00:01<00:05, 5894.11it/s]loading adj matrices:  27%|██▋       | 10970/40712 [00:01<00:05, 5933.56it/s]loading adj matrices:  28%|██▊       | 11567/40712 [00:01<00:04, 5942.45it/s]loading adj matrices:  30%|██▉       | 12164/40712 [00:02<00:04, 5945.92it/s]loading adj matrices:  31%|███▏      | 12767/40712 [00:02<00:04, 5970.66it/s]loading adj matrices:  33%|███▎      | 13366/40712 [00:02<00:04, 5970.87it/s]loading adj matrices:  34%|███▍      | 13964/40712 [00:02<00:04, 5933.21it/s]loading adj matrices:  36%|███▌      | 14572/40712 [00:02<00:04, 5976.71it/s]loading adj matrices:  37%|███▋      | 15171/40712 [00:02<00:04, 5976.67it/s]loading adj matrices:  39%|███▊      | 15769/40712 [00:02<00:04, 5061.88it/s]loading adj matrices:  40%|████      | 16356/40712 [00:02<00:04, 5276.27it/s]loading adj matrices:  42%|████▏     | 16969/40712 [00:02<00:04, 5509.85it/s]loading adj matrices:  43%|████▎     | 17536/40712 [00:03<00:04, 5357.26it/s]loading adj matrices:  45%|████▍     | 18146/40712 [00:03<00:04, 5562.92it/s]loading adj matrices:  46%|████▌     | 18722/40712 [00:03<00:03, 5616.77it/s]loading adj matrices:  47%|████▋     | 19312/40712 [00:03<00:03, 5696.96it/s]loading adj matrices:  49%|████▉     | 19912/40712 [00:03<00:03, 5785.52it/s]loading adj matrices:  50%|█████     | 20495/40712 [00:03<00:03, 5773.98it/s]loading adj matrices:  52%|█████▏    | 21084/40712 [00:03<00:03, 5805.60it/s]loading adj matrices:  53%|█████▎    | 21672/40712 [00:03<00:03, 5825.74it/s]loading adj matrices:  55%|█████▍    | 22256/40712 [00:03<00:03, 5825.53it/s]loading adj matrices:  56%|█████▌    | 22840/40712 [00:03<00:03, 5818.45it/s]loading adj matrices:  58%|█████▊    | 23423/40712 [00:04<00:02, 5812.29it/s]loading adj matrices:  59%|█████▉    | 24005/40712 [00:04<00:02, 5788.82it/s]loading adj matrices:  60%|██████    | 24585/40712 [00:04<00:02, 5774.30it/s]loading adj matrices:  62%|██████▏   | 25163/40712 [00:04<00:02, 5773.98it/s]loading adj matrices:  63%|██████▎   | 25741/40712 [00:04<00:02, 5772.33it/s]loading adj matrices:  65%|██████▍   | 26319/40712 [00:04<00:02, 5732.83it/s]loading adj matrices:  66%|██████▌   | 26893/40712 [00:04<00:02, 5704.15it/s]loading adj matrices:  67%|██████▋   | 27467/40712 [00:04<00:02, 5712.50it/s]loading adj matrices:  69%|██████▉   | 28041/40712 [00:04<00:02, 5719.96it/s]loading adj matrices:  70%|███████   | 28614/40712 [00:04<00:02, 5681.10it/s]loading adj matrices:  72%|███████▏  | 29183/40712 [00:05<00:02, 4281.08it/s]loading adj matrices:  73%|███████▎  | 29748/40712 [00:05<00:02, 4611.12it/s]loading adj matrices:  74%|███████▍  | 30306/40712 [00:05<00:02, 4859.88it/s]loading adj matrices:  76%|███████▌  | 30878/40712 [00:05<00:01, 5090.74it/s]loading adj matrices:  77%|███████▋  | 31440/40712 [00:05<00:01, 5236.37it/s]loading adj matrices:  79%|███████▊  | 32010/40712 [00:05<00:01, 5365.91it/s]loading adj matrices:  80%|████████  | 32580/40712 [00:05<00:01, 5460.83it/s]loading adj matrices:  81%|████████▏ | 33140/40712 [00:05<00:01, 5498.67it/s]loading adj matrices:  83%|████████▎ | 33730/40712 [00:05<00:01, 5614.90it/s]loading adj matrices:  84%|████████▍ | 34309/40712 [00:06<00:01, 5664.25it/s]loading adj matrices:  86%|████████▌ | 34880/40712 [00:06<00:01, 5647.54it/s]loading adj matrices:  87%|████████▋ | 35448/40712 [00:06<00:00, 5620.09it/s]loading adj matrices:  88%|████████▊ | 36012/40712 [00:06<00:00, 5601.89it/s]loading adj matrices:  90%|████████▉ | 36574/40712 [00:06<00:00, 5592.94it/s]loading adj matrices:  91%|█████████ | 37135/40712 [00:06<00:00, 5583.75it/s]loading adj matrices:  93%|█████████▎| 37695/40712 [00:06<00:00, 5560.01it/s]loading adj matrices:  94%|█████████▍| 38267/40712 [00:06<00:00, 5605.58it/s]loading adj matrices:  95%|█████████▌| 38828/40712 [00:06<00:00, 5604.67it/s]loading adj matrices:  97%|█████████▋| 39389/40712 [00:07<00:00, 5580.22it/s]loading adj matrices:  98%|█████████▊| 39948/40712 [00:07<00:00, 5577.14it/s]loading adj matrices:  99%|█████████▉| 40506/40712 [00:07<00:00, 5560.71it/s]loading adj matrices: 100%|██████████| 40712/40712 [00:07<00:00, 5617.38it/s]
| ori_adj_len: 26.49 | adj_len: 26.43 | prune_rate： 0.00 | qc_num: 4.57 | ac_num: 1.06 |
loading adj matrices:   0%|          | 0/5088 [00:00<?, ?it/s]loading adj matrices:  11%|█▏        | 583/5088 [00:00<00:00, 5829.74it/s]loading adj matrices:  23%|██▎       | 1166/5088 [00:00<00:00, 5782.10it/s]loading adj matrices:  34%|███▍      | 1745/5088 [00:00<00:00, 5768.55it/s]loading adj matrices:  46%|████▌     | 2329/5088 [00:00<00:00, 5794.76it/s]loading adj matrices:  57%|█████▋    | 2910/5088 [00:00<00:00, 5799.91it/s]loading adj matrices:  69%|██████▊   | 3491/5088 [00:00<00:00, 5725.12it/s]loading adj matrices:  80%|████████  | 4079/5088 [00:00<00:00, 5774.83it/s]loading adj matrices:  92%|█████████▏| 4666/5088 [00:00<00:00, 5804.69it/s]loading adj matrices: 100%|██████████| 5088/5088 [00:00<00:00, 5795.25it/s]
| ori_adj_len: 25.20 | adj_len: 25.20 | prune_rate： 0.00 | qc_num: 4.34 | ac_num: 1.07 |
loading adj matrices:   0%|          | 0/5092 [00:00<?, ?it/s]loading adj matrices:  11%|█▏        | 581/5092 [00:00<00:00, 5807.51it/s]loading adj matrices:  23%|██▎       | 1190/5092 [00:00<00:00, 5973.34it/s]loading adj matrices:  35%|███▌      | 1788/5092 [00:00<00:00, 5941.41it/s]loading adj matrices:  47%|████▋     | 2383/5092 [00:00<00:00, 5866.81it/s]loading adj matrices:  58%|█████▊    | 2971/5092 [00:00<00:00, 5869.52it/s]loading adj matrices:  70%|███████   | 3569/5092 [00:00<00:00, 5905.36it/s]loading adj matrices:  82%|████████▏ | 4160/5092 [00:00<00:00, 5877.67it/s]loading adj matrices:  93%|█████████▎| 4748/5092 [00:00<00:00, 5835.97it/s]loading adj matrices: 100%|██████████| 5092/5092 [00:00<00:00, 5862.18it/s]
| ori_adj_len: 26.09 | adj_len: 26.06 | prune_rate： 0.00 | qc_num: 4.61 | ac_num: 1.06 |

***** runing evaluation *****
| dataset: medqa_usmle | num_dev: 1272 | num_test: 1273 | save_dir: ./saved_models/medqa_usmle/drlk__ds_medqa_usmle__enc_cambridgeltl--SapBERT-from-PubMedBERT-fulltext__gnn_4__sd_0__20220808_085911/ |
./preds_res/medqa_usmle/drlk__ds_medqa_usmle__enc_cambridgeltl--SapBERT-from-PubMedBERT-fulltext__gnn_4__sd_0__20220808_085911/dev_preds.csv*****结果保存成功******
*****dev evaluation done *****
./preds_res/medqa_usmle/drlk__ds_medqa_usmle__enc_cambridgeltl--SapBERT-from-PubMedBERT-fulltext__gnn_4__sd_0__20220808_085911/test_preds.csv*****结果保存成功******
*****test evaluation done *****

| dev_accuracy: 0.39072327044025157 | test_acc: 0.40377062058130403 |
